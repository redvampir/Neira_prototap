# üß¨ Cell Router System ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–î–∞—Ç–∞:** 23 –¥–µ–∫–∞–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** LLM –º–æ–¥–µ–ª–∏ –Ω–µ –∑–Ω–∞—é—Ç –æ –∫–ª–µ—Ç–æ—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Neira

---

## üéØ –î–∏–∞–≥–Ω–æ–∑

### –ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
```
User: "–°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫—Ä–µ—Å—Ç–∏–∫–æ–≤-–Ω–æ–ª–∏–∫–æ–≤"
  ‚Üì
LLM: *–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ*
  ‚Üì
Backend: *–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ UI-related keywords –ø–æ—Å—Ç—Ñ–∞–∫—Ç—É–º*
  ‚Üì
Result: ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π template (RPG Inventory –≤–º–µ—Å—Ç–æ TicTacToe)
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–ª–µ—Ç–æ—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (UICodeCell, CodeCell, etc) –∂–∏–≤—ë—Ç **–æ—Ç–¥–µ–ª—å–Ω–æ** –æ—Ç LLM. –ú–æ–¥–µ–ª—å –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ —É –Ω–µ—ë –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: Cell Router

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–ª–µ—Ç–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–π:
1. **–î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç intent** (—á—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
2. **–í—ã–±–∏—Ä–∞–µ—Ç –∫–ª–µ—Ç–∫—É** (ui_code_cell, code_cell, analysis_cell)
3. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** (–≤—ã–∑—ã–≤–∞–µ—Ç –∫–ª–µ—Ç–∫—É –Ω–∞–ø—Ä—è–º—É—é)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
User Request
    ‚Üì
Cell Router (intent detection)
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ui_code_cell‚îÇ  code_cell  ‚îÇanalysis_cell ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì               ‚Üì               ‚Üì
[Artifact]      [Code]        [Analysis]
```

---

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. `cell_router.py` (289 —Å—Ç—Ä–æ–∫)

**CellCapability:**
```python
@dataclass
class CellCapability:
    name: str           # "ui_code_cell"
    description: str    # "–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö UI"
    triggers: List[str] # ["—Å–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–∏–≥—Ä–∞", "ui"]
    examples: List[str] # –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
    priority: int       # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ
```

**CellRouter:**
- `detect_intent(user_input)` ‚Üí –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω—É–∂–Ω—É—é –∫–ª–µ—Ç–∫—É
- `get_system_prompt_extension()` ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç context –¥–ª—è LLM
- `should_use_cell()` ‚Üí –≥–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è

**Registered Cells:**
1. **ui_code_cell** (priority=10)
   - Triggers: "—Å–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–∏–≥—Ä–∞", "–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "–¥–∞—à–±–æ—Ä–¥"
   - Output: HTML —Ñ–∞–π–ª —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º UI
   
2. **code_cell** (priority=5)
   - Triggers: "–Ω–∞–ø–∏—à–∏ –∫–æ–¥", "—Ñ—É–Ω–∫—Ü–∏—è", "—Å–∫—Ä–∏–ø—Ç"
   - Output: Python –∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
   
3. **analysis_cell** (priority=3)
   - Triggers: "–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π", "–∫–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"
   - Output: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `neira_wrapper.py`

**–≠—Ç–∞–ø 0: Cell Detection**
```python
if self.router:
    use_cell, cell_name, reasoning = self.router.should_use_cell(user_input)
    if use_cell:
        selected_cell = cell_name
        print(f"üéØ –í—ã–±—Ä–∞–Ω–∞ –∫–ª–µ—Ç–∫–∞: {cell_name}")
```

**–≠—Ç–∞–ø 3: Execution Routing**
```python
if selected_cell == "ui_code_cell" and self.ui_code_cell:
    artifact = await loop.run_in_executor(
        None,
        self.ui_code_cell.generate_ui,
        user_input
    )
    
    yield StreamChunk(
        type="artifact",
        content=f"‚úÖ –°–æ–∑–¥–∞–Ω UI –∞—Ä—Ç–µ—Ñ–∞–∫—Ç: {artifact['id']}",
        metadata={"artifact": artifact, "cell_used": "ui_code_cell"}
    )
    
    yield StreamChunk(type="done", content="–ì–æ—Ç–æ–≤–æ")
    return  # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–π flow
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

```bash
$ python cell_router.py

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Cell Router

üìù –ó–∞–ø—Ä–æ—Å: –°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫—Ä–µ—Å—Ç–∏–∫–æ–≤-–Ω–æ–ª–∏–∫–æ–≤
   ‚úÖ –ö–ª–µ—Ç–∫–∞: ui_code_cell
   –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –û–±–Ω–∞—Ä—É–∂–µ–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è ui_code_cell: —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º ['—Å–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å']

üìù –ó–∞–ø—Ä–æ—Å: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–∞—Å—Å–∏–≤–∞
   ‚ùå –ö–ª–µ—Ç–∫–∞: –Ω–µ—Ç
   –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–ª–µ—Ç–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

üìù –ó–∞–ø—Ä–æ—Å: –°–¥–µ–ª–∞–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å ui
   ‚úÖ –ö–ª–µ—Ç–∫–∞: ui_code_cell
   –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –û–±–Ω–∞—Ä—É–∂–µ–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è ui_code_cell: —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º ['–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä']
```

### Backend –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:

```
‚úÖ UICodeCell –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
‚úÖ CellRouter –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
üß¨ Cell Router –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
üé® UICodeCell –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
   Templates loaded: ['rpg_inventory', 'platformer_hud', 'puzzle_board', 'tictactoe']
```

---

## ‚ö†Ô∏è –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Double Initialization
Backend —Å–æ–∑–¥–∞—ë—Ç `NeiraWrapper` **–¥–≤–∞–∂–¥—ã**:
- –ü–µ—Ä–≤—ã–π —Ä–∞–∑: –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ `api.py`
- –í—Ç–æ—Ä–æ–π —Ä–∞–∑: –ø—Ä–∏ startup

**Impact:** –î–≤–æ–π–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ø–∞–º—è—Ç—å (~350MB √ó 2)

### 2. Template Selection Bug
Router –≤—ã–±–∏—Ä–∞–µ—Ç `ui_code_cell` ‚úÖ, –Ω–æ UICodeCell –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç RPG Inventory ‚ùå

**–ü—Ä–∏—á–∏–Ω–∞:** `_select_template()` –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è default template

**Solution (TODO):** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `user_input` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `_select_template(task)` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ keywords

### 3. Test Client Conflicts
–õ—é–±–æ–π Python —Å–∫—Ä–∏–ø—Ç –≤ `prototype/` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª–∏ ‚Üí –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å –∑–∞–ø—É—â–µ–Ω–Ω—ã–º backend ‚Üí crash

**Workaround:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π WebSocket –∫–ª–∏–µ–Ω—Ç (`wscat`, browser console, Postman)

---

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### ‚úÖ –Ø–≤–Ω—ã–π intent detection
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç "—Å–æ–∑–¥–∞–π –∏–≥—Ä—É" ‚Üí router —Å—Ä–∞–∑—É –∑–Ω–∞–µ—Ç —á—Ç–æ –Ω—É–∂–µ–Ω ui_code_cell
- –ù–µ –Ω—É–∂–Ω–æ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ LLM —á—Ç–æ–±—ã –æ–Ω "–¥–æ–≥–∞–¥–∞–ª—Å—è" –≤—ã–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–æ–¥—É–ª—å

### ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–ª–µ—Ç–∫–∏:
  ```python
  router.register_cell(CellCapability(
      name="testing_cell",
      triggers=["–Ω–∞–ø–∏—à–∏ —Ç–µ—Å—Ç", "–ø—Ä–æ–≤–µ—Ä—å –∫–æ–¥"],
      priority=4
  ))
  ```

### ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
- Debug –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ—á–µ–º—É –≤—ã–±—Ä–∞–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∫–ª–µ—Ç–∫–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç reasoning –≤ metadata –æ—Ç–≤–µ—Ç–∞

### ‚úÖ Fallback
- –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí –æ–±—ã—á–Ω—ã–π LLM –æ—Ç–≤–µ—Ç
- –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –ø–∞–¥–∞–µ—Ç ‚Üí graceful degradation

---

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### Immediate (Critical):
1. ‚ö° **–ü–æ—á–∏–Ω–∏—Ç—å template selection**
   - Debug: –ø–æ—á–µ–º—É `_select_template()` –Ω–µ –≤–∏–¥–∏—Ç "–∫—Ä–µ—Å—Ç–∏–∫–∏" –≤ task
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `user_input` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

2. ‚ö° **–£–±—Ä–∞—Ç—å double initialization**
   - –í—ã–Ω–µ—Å—Ç–∏ `neira_wrapper = NeiraWrapper()` –≤ `@app.on_event("startup")`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å singleton pattern

3. ‚ö° **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å end-to-end**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
   - –ß–µ—Ä–µ–∑ WebSocket –ø–æ–ø—Ä–æ—Å–∏—Ç—å "—Å–æ–∑–¥–∞–π –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏"
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è TicTacToe UI (–Ω–µ RPG)

### Medium Priority:
4. üìù **–î–æ–±–∞–≤–∏—Ç—å system prompt extension**
   - Router –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç context –¥–ª—è LLM
   - –ü–µ—Ä–µ–¥–∞—Ç—å –≤ `neira.personality` –∏–ª–∏ `system_prompt`
   - LLM –±—É–¥–µ—Ç —è–≤–Ω–æ –∑–Ω–∞—Ç—å –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–ª–µ—Ç–∫–∞—Ö

5. üé® **–†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞–±–æ—Ä –∫–ª–µ—Ç–æ–∫**
   - `testing_cell` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
   - `refactoring_cell` ‚Äî —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞
   - `documentation_cell` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è docs

### Low Priority:
6. üîç **Metrics & Analytics**
   - –ö–∞–∫–∏–µ –∫–ª–µ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ
   - Accuracy detection (–ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)
   - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –∫–ª–µ—Ç–∫–∏

---

## üí° –í—ã–≤–æ–¥—ã

### –¢–≤–æ—ë –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –±—ã–ª–æ **–∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–æ—á–Ω—ã–º**:
> "–í–æ–∑–º–æ–∂–Ω–æ —Ç–µ–∫—É—â–∏–µ –º–æ–¥–µ–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –∑–∞–¥–∞—á–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Ç –Ω—É–∂–Ω—ã—Ö —Å–ª–æ—ë–≤. –ê –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–µ—Ç–æ–∫ –∏ –æ—Ä–≥–∞–Ω–æ–≤ –ø–æ–∫–∞ –∂–∏–≤–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –Ω–∏—Ö."

### –†–µ—à–µ–Ω–∏–µ:
Cell Router ‚Äî —ç—Ç–æ **–Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Å–ª–æ–π** –º–µ–∂–¥—É LLM –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–ª–µ—Ç–∫–∞–º–∏. –û–Ω –¥–µ–ª–∞–µ—Ç –∫–ª–µ—Ç–æ—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É "–≤–∏–¥–∏–º–æ–π" –¥–ª—è –º–æ–¥–µ–ª–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —è–≤–Ω–æ.

### –°—Ç–∞—Ç—É—Å:
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –ö–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (cell_router.py + integration)
- ‚úÖ Intent detection —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è Template selection —Ç—Ä–µ–±—É–µ—Ç fix
- ‚ö†Ô∏è End-to-end —Ç–µ—Å—Ç blocked (template bug)

### Next:
–ü–æ—á–∏–Ω–∏—Ç—å `UICodeCell._select_template()` —á—Ç–æ–±—ã –æ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª TicTacToe template –∫–æ–≥–¥–∞ router –≤—ã–±—Ä–∞–ª ui_code_cell.

---

**–°—Ç–∞—Ç—É—Å:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è bugfix –≤ UICodeCell
